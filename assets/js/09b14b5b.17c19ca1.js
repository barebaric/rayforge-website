"use strict";(self.webpackChunkwebsite_new=self.webpackChunkwebsite_new||[]).push([[3762],{26967(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"machine/hooks-macros","title":"Macros & Hooks","description":"Rayforge provides two powerful automation features for customizing your workflow: Macros and Hooks. Both allow you to inject custom G-code into your jobs, but they serve different purposes.","source":"@site/docs/machine/hooks-macros.md","sourceDirName":"machine","slug":"/machine/hooks-macros","permalink":"/docs/machine/hooks-macros","draft":false,"unlisted":false,"editUrl":"https://github.com/barebaric/rayforge/tree/main/website/docs/docs/machine/hooks-macros.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"G-code Settings","permalink":"/docs/machine/gcode"},"next":{"title":"Device Settings","permalink":"/docs/machine/device"}}');var i=s(74848),o=s(28453);const t={},l="Macros & Hooks",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Macros",id:"macros",level:2},{value:"What Are Macros For?",id:"what-are-macros-for",level:3},{value:"Creating a Macro",id:"creating-a-macro",level:3},{value:"Example Macros",id:"example-macros",level:3},{value:"Simple: Home the Machine",id:"simple-home-the-machine",level:4},{value:"Medium: Set Work Offset",id:"medium-set-work-offset",level:4},{value:"Advanced: Focus Test Grid",id:"advanced-focus-test-grid",level:4},{value:"Macro Examples",id:"macro-examples",level:3},{value:"Hook Triggers",id:"hook-triggers",level:3},{value:"Creating a Hook",id:"creating-a-hook",level:3},{value:"Example Hooks",id:"example-hooks",level:3},{value:"Job Start: Initialize Machine",id:"job-start-initialize-machine",level:4},{value:"Job End: Return Home and Beep",id:"job-end-return-home-and-beep",level:4},{value:"Layer Start: Add Comment",id:"layer-start-add-comment",level:4},{value:"Workpiece Start: Part Numbering",id:"workpiece-start-part-numbering",level:4},{value:"Hook Execution Order",id:"hook-execution-order",level:3},{value:"Variable Substitution",id:"variable-substitution",level:2},{value:"Available Variables",id:"available-variables",level:3},{value:"Example: Progress Notification",id:"example-progress-notification",level:3},{value:"Advanced Use Cases",id:"advanced-use-cases",level:2},{value:"Multi-Tool Setup",id:"multi-tool-setup",level:3},{value:"Conditional Pauses",id:"conditional-pauses",level:3},{value:"Air Assist Per Layer",id:"air-assist-per-layer",level:3},{value:"Safety Considerations",id:"safety-considerations",level:2},{value:"Related Pages",id:"related-pages",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"macros--hooks",children:"Macros & Hooks"})}),"\n",(0,i.jsxs)(n.p,{children:["Rayforge provides two powerful automation features for customizing your workflow: ",(0,i.jsx)(n.strong,{children:"Macros"})," and ",(0,i.jsx)(n.strong,{children:"Hooks"}),". Both allow you to inject custom G-code into your jobs, but they serve different purposes."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Hooks &amp; Macros Settings",src:s(58324).A+"",width:"922",height:"922"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"Purpose"}),(0,i.jsx)(n.th,{children:"Trigger"}),(0,i.jsx)(n.th,{children:"Use Case"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Macros"})}),(0,i.jsx)(n.td,{children:"Reusable G-code snippets"}),(0,i.jsx)(n.td,{children:"Manual execution"}),(0,i.jsx)(n.td,{children:"Quick commands, test patterns, custom routines"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Hooks"})}),(0,i.jsx)(n.td,{children:"Automatic G-code injection"}),(0,i.jsx)(n.td,{children:"Job lifecycle events"}),(0,i.jsx)(n.td,{children:"Startup sequences, layer changes, cleanup"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"macros",children:"Macros"}),"\n",(0,i.jsxs)(n.p,{children:["Macros are ",(0,i.jsx)(n.strong,{children:"named, reusable G-code scripts"})," that you can execute manually at any time."]}),"\n",(0,i.jsx)(n.h3,{id:"what-are-macros-for",children:"What Are Macros For?"}),"\n",(0,i.jsx)(n.p,{children:"Common macro use cases:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Homing the machine"})," - Send ",(0,i.jsx)(n.code,{children:"$H"})," quickly"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Setting work offsets"})," - Store and recall G54/G55 positions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Air assist control"})," - Toggle air assist on/off"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Focus testing"})," - Run a quick focus test pattern"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Custom tool changes"})," - For multi-laser setups"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Emergency routines"})," - Quick shutdown or alarm clear"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Material probing"})," - Auto-focus or height measurement"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"creating-a-macro",children:"Creating a Macro"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open Machine Settings:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"Settings Machine Macros"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add a new macro:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Click the ",(0,i.jsx)(n.strong,{children:'"+"'})," button"]}),"\n",(0,i.jsx)(n.li,{children:'Enter a descriptive name (e.g., "Home Machine", "Enable Air Assist")'}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Write your G-code:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Each line is a separate G-code command"}),"\n",(0,i.jsxs)(n.li,{children:["Comments start with ",(0,i.jsx)(n.code,{children:";"})," or ",(0,i.jsx)(n.code,{children:"("})]}),"\n",(0,i.jsx)(n.li,{children:"Variables can be used (see Variable Substitution below)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Save the macro"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Execute the macro:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"From the macros list, click the macro"}),"\n",(0,i.jsx)(n.li,{children:"Or assign a keyboard shortcut (if supported)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-macros",children:"Example Macros"}),"\n",(0,i.jsx)(n.h4,{id:"simple-home-the-machine",children:"Simple: Home the Machine"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Name:"})," Home Machine\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"$H\n; Waits for homing to complete\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use:"})," Quickly home the machine before starting work."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"medium-set-work-offset",children:"Medium: Set Work Offset"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Name:"})," Set G54 to Current Position\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"G10 L20 P1 X0 Y0\n; Sets G54 work coordinate system origin to current position\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use:"})," Mark the current laser position as the job origin."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"advanced-focus-test-grid",children:"Advanced: Focus Test Grid"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Name:"})," 9-Point Focus Test\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"; 9-point grid for finding optimal focus\nG21  ; Millimeters\nG90  ; Absolute positioning\nG0 X10 Y10\nM3 S1000\nG4 P0.1\nM5\nG0 X20 Y10\nM3 S1000\nG4 P0.1\nM5\n; ... (repeat for remaining points)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use:"})," Quickly test focus at different positions on the bed."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"macro-examples",children:"Macro Examples"}),"\n",(0,i.jsxs)(n.p,{children:["Hooks are ",(0,i.jsx)(n.strong,{children:"automatic G-code injections"})," triggered by specific events during job execution."]}),"\n",(0,i.jsx)(n.h3,{id:"hook-triggers",children:"Hook Triggers"}),"\n",(0,i.jsx)(n.p,{children:"Rayforge supports these hook triggers:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Trigger"}),(0,i.jsx)(n.th,{children:"When It Runs"}),(0,i.jsx)(n.th,{children:"Common Uses"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Job Start"})}),(0,i.jsx)(n.td,{children:"Very beginning of the job"}),(0,i.jsx)(n.td,{children:"Homing, work offset, air assist on, preheat"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Job End"})}),(0,i.jsx)(n.td,{children:"Very end of the job"}),(0,i.jsx)(n.td,{children:"Return home, air assist off, beep, cooldown"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Layer Start"})}),(0,i.jsx)(n.td,{children:"Before processing each layer"}),(0,i.jsx)(n.td,{children:"Tool change, power adjust, comments"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Layer End"})}),(0,i.jsx)(n.td,{children:"After processing each layer"}),(0,i.jsx)(n.td,{children:"Progress notification, pause"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Workpiece Start"})}),(0,i.jsx)(n.td,{children:"Before processing each workpiece"}),(0,i.jsx)(n.td,{children:"Part numbering, alignment marks"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Workpiece End"})}),(0,i.jsx)(n.td,{children:"After processing each workpiece"}),(0,i.jsx)(n.td,{children:"Cooldown, inspection pause"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"creating-a-hook",children:"Creating a Hook"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open Machine Settings:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"Settings Machine Hooks"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Select a trigger:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Choose the event when this hook should run"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Write your G-code:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Hook code is injected at the trigger point"}),"\n",(0,i.jsx)(n.li,{children:"Use variables for dynamic values (see below)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Enable/disable:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Toggle hooks on/off without deleting them"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-hooks",children:"Example Hooks"}),"\n",(0,i.jsx)(n.h4,{id:"job-start-initialize-machine",children:"Job Start: Initialize Machine"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger:"})," Job Start\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"G21         ; Millimeters\nG90         ; Absolute positioning\n$H          ; Home the machine\nG0 X0 Y0    ; Move to origin\nM3 S0       ; Laser on but power 0 (some controllers need this)\nM8          ; Air assist ON\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose:"})," Ensures machine is in a known state before every job."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"job-end-return-home-and-beep",children:"Job End: Return Home and Beep"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger:"})," Job End\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"M5          ; Laser OFF\nM9          ; Air assist OFF\nG0 X0 Y0    ; Return to origin\nM300 S800 P200  ; Beep (if supported)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose:"})," Safely ends the job and signals completion."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"layer-start-add-comment",children:"Layer Start: Add Comment"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger:"})," Layer Start\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"; Starting layer: {layer_name}\n; Layer index: {layer_index}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose:"})," Makes G-code more readable for debugging."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"workpiece-start-part-numbering",children:"Workpiece Start: Part Numbering"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger:"})," Workpiece Start\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"; Part: {workpiece_name}\n; Part {workpiece_index} of {total_workpieces}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Purpose:"})," Track progress in multi-part jobs."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"hook-execution-order",children:"Hook Execution Order"}),"\n",(0,i.jsx)(n.p,{children:"For a job with 2 layers, each with 2 workpieces:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[Job Start Hook]\n  [Layer Start Hook] (Layer 1)\n    [Workpiece Start Hook] (Workpiece 1)\n      ... workpiece 1 G-code ...\n    [Workpiece End Hook] (Workpiece 1)\n    [Workpiece Start Hook] (Workpiece 2)\n      ... workpiece 2 G-code ...\n    [Workpiece End Hook] (Workpiece 2)\n  [Layer End Hook] (Layer 1)\n  [Layer Start Hook] (Layer 2)\n    [Workpiece Start Hook] (Workpiece 3)\n      ... workpiece 3 G-code ...\n    [Workpiece End Hook] (Workpiece 3)\n    [Workpiece Start Hook] (Workpiece 4)\n      ... workpiece 4 G-code ...\n    [Workpiece End Hook] (Workpiece 4)\n  [Layer End Hook] (Layer 2)\n[Job End Hook]\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"variable-substitution",children:"Variable Substitution"}),"\n",(0,i.jsxs)(n.p,{children:["Both macros and hooks support ",(0,i.jsx)(n.strong,{children:"variable substitution"})," to inject dynamic values."]}),"\n",(0,i.jsx)(n.h3,{id:"available-variables",children:"Available Variables"}),"\n",(0,i.jsxs)(n.p,{children:["Variables use ",(0,i.jsx)(n.code,{children:"{variable_name}"})," syntax and are replaced during G-code generation."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Job-level variables:"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{job_name}"})}),(0,i.jsx)(n.td,{children:"Name of the current job/document"}),(0,i.jsx)(n.td,{children:'"test-job"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{date}"})}),(0,i.jsx)(n.td,{children:"Current date"}),(0,i.jsx)(n.td,{children:'"2025-10-03"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{time}"})}),(0,i.jsx)(n.td,{children:"Current time"}),(0,i.jsx)(n.td,{children:'"14:30:25"'})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Layer-level variables:"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{layer_name}"})}),(0,i.jsx)(n.td,{children:"Name of the current layer"}),(0,i.jsx)(n.td,{children:'"Cut Layer"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{layer_index}"})}),(0,i.jsx)(n.td,{children:"Zero-based index of current layer"}),(0,i.jsx)(n.td,{children:"0, 1, 2..."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{total_layers}"})}),(0,i.jsx)(n.td,{children:"Total number of layers in job"}),(0,i.jsx)(n.td,{children:"3"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Workpiece-level variables:"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{workpiece_name}"})}),(0,i.jsx)(n.td,{children:"Name of the workpiece"}),(0,i.jsx)(n.td,{children:'"Circle 1"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{workpiece_index}"})}),(0,i.jsx)(n.td,{children:"Zero-based index of current workpiece"}),(0,i.jsx)(n.td,{children:"0, 1, 2..."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{total_workpieces}"})}),(0,i.jsx)(n.td,{children:"Total number of workpieces"}),(0,i.jsx)(n.td,{children:"5"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Machine variables:"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Variable"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{machine_name}"})}),(0,i.jsx)(n.td,{children:"Name of the machine profile"}),(0,i.jsx)(n.td,{children:'"My K40"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{max_speed}"})}),(0,i.jsx)(n.td,{children:"Maximum cutting speed (mm/min)"}),(0,i.jsx)(n.td,{children:"1000"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{work_width}"})}),(0,i.jsx)(n.td,{children:"Work area width (mm)"}),(0,i.jsx)(n.td,{children:"300"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{work_height}"})}),(0,i.jsx)(n.td,{children:"Work area height (mm)"}),(0,i.jsx)(n.td,{children:"200"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"example-progress-notification",children:"Example: Progress Notification"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hook:"})," Layer Start\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"; ========================================\n; Layer {layer_index} of {total_layers}: {layer_name}\n; Job: {job_name}\n; Time: {time}\n; ========================================\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Result in G-code:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"; ========================================\n; Layer 0 of 3: Cut Layer\n; Job: test-project\n; Time: 14:30:25\n; ========================================\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"advanced-use-cases",children:"Advanced Use Cases"}),"\n",(0,i.jsx)(n.h3,{id:"multi-tool-setup",children:"Multi-Tool Setup"}),"\n",(0,i.jsx)(n.p,{children:"For machines with multiple lasers or tools:"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hook:"})," Workpiece Start\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"; Select tool for workpiece {workpiece_name}\nT{tool_number}  ; Tool change command (if supported)\nG4 P1           ; Wait for tool change\n"})}),"\n",(0,i.jsx)(n.h3,{id:"conditional-pauses",children:"Conditional Pauses"}),"\n",(0,i.jsx)(n.p,{children:"Add optional pauses for inspection:"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hook:"})," Layer End\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"; M0  ; Uncomment to pause after each layer for inspection\n"})}),"\n",(0,i.jsx)(n.h3,{id:"air-assist-per-layer",children:"Air Assist Per Layer"}),"\n",(0,i.jsx)(n.p,{children:"Control air assist on a per-layer basis:"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hook:"})," Layer Start (for cutting layers)\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"M8  ; Air assist ON\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Hook:"})," Layer Start (for engraving layers)\n",(0,i.jsx)(n.strong,{children:"Code:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-gcode",children:"M9  ; Air assist OFF (prevents dust scattering for engraving)\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Layer-Specific Hooks",type:"note",children:(0,i.jsx)(n.p,{children:"Rayforge doesn't currently support per-layer hook customization. To achieve this, use conditional G-code or separate machine profiles."})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"safety-considerations",children:"Safety Considerations"}),"\n",(0,i.jsxs)(n.admonition,{title:"Test Before Production",type:"danger",children:[(0,i.jsxs)(n.p,{children:["Always test macros and hooks in ",(0,i.jsx)(n.strong,{children:"simulation mode"})," or with the laser ",(0,i.jsx)(n.strong,{children:"disabled"})," before running on real jobs. Incorrectly configured G-code can:"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Crash the machine into limits"}),"\n",(0,i.jsx)(n.li,{children:"Fire the laser unexpectedly"}),"\n",(0,i.jsx)(n.li,{children:"Damage materials or equipment"}),"\n"]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Safety checklist:"})}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," Macros include feedrate limits (",(0,i.jsx)(n.code,{children:"F"})," parameter)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," Macros check position bounds"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," Job Start hooks include ",(0,i.jsx)(n.code,{children:"M5"})," or laser off command"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," Job End hooks turn off laser (",(0,i.jsx)(n.code,{children:"M5"}),") and air assist (",(0,i.jsx)(n.code,{children:"M9"}),")"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," No destructive commands without confirmation"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," Tested in simulation or with laser disabled"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"related-pages",children:"Related Pages"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"device",children:"Device Settings"})," - GRBL command reference"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../reference/gcode-dialects",children:"G-code Dialects"})," - G-code compatibility"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"general",children:"General Settings"})," - Machine configuration"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../features/multi-layer",children:"Multi-Layer Workflow"})," - Using hooks with layers"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},58324(e,n,s){s.d(n,{A:()=>r});const r=s.p+"assets/images/machine-hooks-macros-1df8eec5dc6cd0a592c40fbc135ee51c.png"},28453(e,n,s){s.d(n,{R:()=>t,x:()=>l});var r=s(96540);const i={},o=r.createContext(i);function t(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunkwebsite_new=self.webpackChunkwebsite_new||[]).push([[1603],{620(e,n,r){r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"developer/importer","title":"Importer Architecture","description":"This document describes the architecture of Rayforge\'s file import system,","source":"@site/docs/developer/importer.md","sourceDirName":"developer","slug":"/developer/importer","permalink":"/docs/developer/importer","draft":false,"unlisted":false,"editUrl":"https://github.com/barebaric/rayforge/tree/main/website/docs/docs/developer/importer.md","tags":[],"version":"current","frontMatter":{},"sidebar":"developerSidebar","previous":{"title":"Document Model Architecture","permalink":"/docs/developer/docmodel"},"next":{"title":"Pipeline Architecture","permalink":"/docs/developer/pipeline"}}');var i=r(74848),t=r(28453);const l={},o="Importer Architecture",d={},c=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Overview",id:"overview",level:2},{value:"Import Pipeline",id:"import-pipeline",level:2},{value:"Phase 1: Parse",id:"phase-1-parse",level:3},{value:"Phase 2: Vectorize",id:"phase-2-vectorize",level:3},{value:"Phase 3: Layout",id:"phase-3-layout",level:3},{value:"Phase 4: Assemble",id:"phase-4-assemble",level:3},{value:"Scan Method",id:"scan-method",level:2},{value:"Coordinate Systems",id:"coordinate-systems",level:2},{value:"Native Coordinates (Input)",id:"native-coordinates-input",level:3},{value:"Normalized Coordinates (Intermediate)",id:"normalized-coordinates-intermediate",level:3},{value:"World Coordinates (Output)",id:"world-coordinates-output",level:3},{value:"Y-Axis Orientation",id:"y-axis-orientation",level:3},{value:"Key Classes",id:"key-classes",level:2},{value:"Importer (Base Class)",id:"importer-base-class",level:3},{value:"Data Structures",id:"data-structures",level:3},{value:"Supporting Components",id:"supporting-components",level:3},{value:"Creating a New Importer",id:"creating-a-new-importer",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"importer-architecture",children:"Importer Architecture"})}),"\n",(0,i.jsx)(n.p,{children:"This document describes the architecture of Rayforge's file import system,\nwhich handles converting various file formats (SVG, DXF, PNG, PDF, etc.) into\nRayforge's document model."}),"\n",(0,i.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#overview",children:"Overview"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#import-pipeline",children:"Import Pipeline"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#scan-method",children:"Scan Method"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#coordinate-systems",children:"Coordinate Systems"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#key-classes",children:"Key Classes"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#creating-a-new-importer",children:"Creating a New Importer"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The import system is built around a four-phase pipeline that transforms raw file\ndata into fully-positioned document objects. Each phase has a specific\nresponsibility and produces well-defined data structures."}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart TD\n    raw[raw file data] --\x3e scan\n    raw --\x3e parse\n    scan[Scan<br/>Importer.scan<br/>for metadata] --\x3e|ImportManifest| manifest\n    manifest["ImportManifest"]\n\n    parse[Phase 1: Parse<br/>Importer.parse] --\x3e|ParsingResult| vectorize\n    vectorize[Phase 2: Vectorize<br/>Importer.vectorize] --\x3e|VectorizationResult| layout\n    layout[Phase 3: Layout<br/>NormalizationEngine] --\x3e|List of LayoutItem| assemble\n    assemble[Phase 4: Assemble<br/>ItemAssembler] --\x3e|ImportPayload| result\n    result["ImportResult<br/>final output"]\n\n    classDef scanStyle fill:#f3e5f580,stroke:#9c27b080\n    classDef parseStyle fill:#e1f5fe80,stroke:#03a9f480\n    classDef layoutStyle fill:#fff3e080,stroke:#ffb74d80\n    classDef assembleStyle fill:#e8f5e980,stroke:#4caf5080\n    class scan,manifest scanStyle\n    class parse,vectorize parseStyle\n    class layout layoutStyle\n    class assemble,result assembleStyle'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"import-pipeline",children:"Import Pipeline"}),"\n",(0,i.jsx)(n.h3,{id:"phase-1-parse",children:"Phase 1: Parse"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Method:"})," ",(0,i.jsx)(n.code,{children:"Importer.parse()"})]}),"\n",(0,i.jsx)(n.p,{children:"Extracts geometric facts from the file including bounds, coordinate system\ndetails, and layer information."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output:"})," ",(0,i.jsx)(n.code,{children:"ParsingResult"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"document_bounds"}),": Total canvas size in Native Coordinates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"native_unit_to_mm"}),": Conversion factor to millimeters"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"is_y_down"}),": Y-axis orientation flag"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"layers"}),": List of ",(0,i.jsx)(n.code,{children:"LayerGeometry"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"world_frame_of_reference"}),": World Coordinates (mm, Y-Up)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"background_world_transform"}),": Matrix for background positioning"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"untrimmed_document_bounds"}),": Reference for Y-inversion"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Coordinate System:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"document_bounds"}),": Native Coordinates (file-specific)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"world_frame_of_reference"}),": World Coordinates (mm, Y-Up)"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"phase-2-vectorize",children:"Phase 2: Vectorize"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Method:"})," ",(0,i.jsx)(n.code,{children:"Importer.vectorize()"})]}),"\n",(0,i.jsxs)(n.p,{children:["Converts parsed data into vector ",(0,i.jsx)(n.code,{children:"Geometry"})," objects according to the\n",(0,i.jsx)(n.code,{children:"VectorizationSpec"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output:"})," ",(0,i.jsx)(n.code,{children:"VectorizationResult"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"geometries_by_layer"}),": Vector geometry per layer (Native Coordinates)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"source_parse_result"}),": Reference to original ParsingResult"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fills_by_layer"}),": Optional fill geometry (Sketch importer)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Coordinate System:"})," Native Coordinates (file-specific)"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"phase-3-layout",children:"Phase 3: Layout"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Class:"})," ",(0,i.jsx)(n.code,{children:"NormalizationEngine"})]}),"\n",(0,i.jsx)(n.p,{children:"Calculates transformation matrices to map Native Coordinates to World\nCoordinates based on user intent."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output:"})," ",(0,i.jsx)(n.code,{children:"List[LayoutItem]"})]}),"\n",(0,i.jsxs)(n.p,{children:["Each ",(0,i.jsx)(n.code,{children:"LayoutItem"})," contains:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"world_matrix"}),": Normalized (0-1, Y-Up) \u2192 World (mm, Y-Up)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"normalization_matrix"}),": Native \u2192 Normalized (0-1, Y-Up)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"crop_window"}),": Subset of original file in Native Coordinates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"layer_id"}),", ",(0,i.jsx)(n.code,{children:"layer_name"}),": Layer identification"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Coordinate System:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Input: Native Coordinates"}),"\n",(0,i.jsx)(n.li,{children:"Output: World Coordinates (mm, Y-Up) via intermediate Normalized space"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"phase-4-assemble",children:"Phase 4: Assemble"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Class:"})," ",(0,i.jsx)(n.code,{children:"ItemAssembler"})]}),"\n",(0,i.jsxs)(n.p,{children:["Instantiates Rayforge domain objects (",(0,i.jsx)(n.code,{children:"WorkPiece"}),", ",(0,i.jsx)(n.code,{children:"Layer"}),") based on the\nlayout plan."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output:"})," ",(0,i.jsx)(n.code,{children:"ImportPayload"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"source"}),": The ",(0,i.jsx)(n.code,{children:"SourceAsset"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"items"}),": List of ",(0,i.jsx)(n.code,{children:"DocItem"})," ready for insertion"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sketches"}),": Optional list of ",(0,i.jsx)(n.code,{children:"Sketch"})," objects"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Coordinate System:"})," All DocItems in World Coordinates (mm, Y-Up)"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"scan-method",children:"Scan Method"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Method:"})," ",(0,i.jsx)(n.code,{children:"Importer.scan()"})]}),"\n",(0,i.jsxs)(n.p,{children:["A lightweight scan that extracts metadata without full processing. Used for\nbuilding the UI for an importer, including layer selection list.\nThis is NOT part of the main import pipeline executed by ",(0,i.jsx)(n.code,{children:"get_doc_items()"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Output:"})," ",(0,i.jsx)(n.code,{children:"ImportManifest"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"layers"}),": List of ",(0,i.jsx)(n.code,{children:"LayerInfo"})," objects"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"natural_size_mm"}),": Physical dimensions in millimeters (Y-Up)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"title"}),": Optional document title"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"warnings"}),", ",(0,i.jsx)(n.code,{children:"errors"}),": Non-critical issues discovered"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Coordinate System:"})," World Coordinates (mm, Y-Up) for ",(0,i.jsx)(n.code,{children:"natural_size_mm"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"coordinate-systems",children:"Coordinate Systems"}),"\n",(0,i.jsx)(n.p,{children:"The import pipeline handles multiple coordinate systems through careful\ntransformation:"}),"\n",(0,i.jsx)(n.h3,{id:"native-coordinates-input",children:"Native Coordinates (Input)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"File-specific coordinate system (SVG user units, DXF units, pixels)"}),"\n",(0,i.jsx)(n.li,{children:"Y-axis orientation varies by format"}),"\n",(0,i.jsx)(n.li,{children:"Bounds are absolute within the document's coordinate space"}),"\n",(0,i.jsxs)(n.li,{children:["Units converted to mm via ",(0,i.jsx)(n.code,{children:"native_unit_to_mm"})," factor"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"normalized-coordinates-intermediate",children:"Normalized Coordinates (Intermediate)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Unit square from (0,0) to (1,1)"}),"\n",(0,i.jsx)(n.li,{children:"Y-axis points UP (Y-Up convention)"}),"\n",(0,i.jsx)(n.li,{children:"Used as intermediate representation between native and world"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"world-coordinates-output",children:"World Coordinates (Output)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Physical world coordinates in millimeters (mm)"}),"\n",(0,i.jsx)(n.li,{children:"Y-axis points UP (Y-Up convention)"}),"\n",(0,i.jsx)(n.li,{children:"Origin (0,0) is at the bottom-left of the workpiece"}),"\n",(0,i.jsx)(n.li,{children:"All positions are absolute in the world coordinate system"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"y-axis-orientation",children:"Y-Axis Orientation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Y-Down formats"})," (SVG, images): Origin at top-left, Y increases downward"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Y-Up formats"})," (DXF): Origin at bottom-left, Y increases upward"]}),"\n",(0,i.jsxs)(n.li,{children:["Importers must set ",(0,i.jsx)(n.code,{children:"is_y_down"})," flag correctly in ",(0,i.jsx)(n.code,{children:"ParsingResult"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"NormalizationEngine"})," handles Y-inversion for Y-Down sources"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"key-classes",children:"Key Classes"}),"\n",(0,i.jsx)(n.h3,{id:"importer-base-class",children:"Importer (Base Class)"}),"\n",(0,i.jsxs)(n.p,{children:["Abstract base class defining the interface for all importers. Subclasses must\nimplement the pipeline methods and declare their capabilities via the\n",(0,i.jsx)(n.code,{children:"features"})," attribute."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Features:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"BITMAP_TRACING"}),": Can trace raster images to vectors"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DIRECT_VECTOR"}),": Can extract vector geometry directly"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"LAYER_SELECTION"}),": Supports layer-based imports"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"PROCEDURAL_GENERATION"}),": Generates content programmatically"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"data-structures",children:"Data Structures"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Class"}),(0,i.jsx)(n.th,{children:"Phase"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LayerInfo"})}),(0,i.jsx)(n.td,{children:"Scan"}),(0,i.jsx)(n.td,{children:"Lightweight layer metadata"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ImportManifest"})}),(0,i.jsx)(n.td,{children:"Scan"}),(0,i.jsx)(n.td,{children:"Scan phase result"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LayerGeometry"})}),(0,i.jsx)(n.td,{children:"Parse"}),(0,i.jsx)(n.td,{children:"Geometric layer info"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ParsingResult"})}),(0,i.jsx)(n.td,{children:"Parse"}),(0,i.jsx)(n.td,{children:"Geometric facts"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VectorizationResult"})}),(0,i.jsx)(n.td,{children:"Vectorize"}),(0,i.jsx)(n.td,{children:"Vector geometry"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LayoutItem"})}),(0,i.jsx)(n.td,{children:"Layout"}),(0,i.jsx)(n.td,{children:"Transformation config"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ImportPayload"})}),(0,i.jsx)(n.td,{children:"Assemble"}),(0,i.jsx)(n.td,{children:"Final output"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ImportResult"})}),(0,i.jsx)(n.td,{children:"Final"}),(0,i.jsx)(n.td,{children:"Complete result wrapper"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"supporting-components",children:"Supporting Components"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"NormalizationEngine"}),": Phase 3 layout calculations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ItemAssembler"}),": Phase 4 object creation"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"creating-a-new-importer",children:"Creating a New Importer"}),"\n",(0,i.jsx)(n.p,{children:"To add support for a new file format:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create a new importer class"})," that inherits from ",(0,i.jsx)(n.code,{children:"Importer"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Declare supported features"})," via the ",(0,i.jsx)(n.code,{children:"features"})," class attribute"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Implement the required methods"}),":\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scan()"}),": Extract metadata quickly (for UI previews)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"parse()"}),": Extract geometric facts"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"vectorize()"}),": Convert to vector geometry"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create_source_asset()"}),": Create the source asset"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Register the importer"})," in ",(0,i.jsx)(n.code,{children:"rayforge/image/__init__.py"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Add MIME type and extension mappings"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from rayforge.image.base_importer import Importer, ImporterFeature\nfrom rayforge.image.structures import (\n    ImportManifest,\n    ParsingResult,\n    VectorizationResult,\n)\nfrom rayforge.core.source_asset import SourceAsset\n\nclass MyFormatImporter(Importer):\n    label = "My Format"\n    mime_types = ("application/x-myformat",)\n    extensions = (".myf",)\n    features = {ImporterFeature.DIRECT_VECTOR}\n\n    def scan(self) -> ImportManifest:\n        # Extract metadata without full processing\n        return ImportManifest(\n            layers=[],\n            natural_size_mm=(100.0, 100.0),\n        )\n\n    def parse(self) -> Optional[ParsingResult]:\n        # Extract geometric facts\n        return ParsingResult(\n            document_bounds=(0, 0, 100, 100),\n            native_unit_to_mm=1.0,\n            is_y_down=False,\n            layers=[],\n            world_frame_of_reference=(0, 0, 100, 100),\n            background_world_transform=Matrix.identity(),\n        )\n\n    def vectorize(\n        self, parse_result: ParsingResult, spec: VectorizationSpec\n    ) -> VectorizationResult:\n        # Convert to vector geometry\n        return VectorizationResult(\n            geometries_by_layer={None: Geometry()},\n            source_parse_result=parse_result,\n        )\n\n    def create_source_asset(\n        self, parse_result: ParsingResult\n    ) -> SourceAsset:\n        # Create the source asset\n        return SourceAsset(\n            original_data=self.raw_data,\n            metadata={},\n        )\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453(e,n,r){r.d(n,{R:()=>l,x:()=>o});var s=r(96540);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);